local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local Workspace = game:GetService("Workspace")
local VirtualInputManager = game:GetService("VirtualInputManager")
local RunService = game:GetService("RunService")
local Lighting = game:GetService("Lighting")
local lp = Players.LocalPlayer

local Network = ReplicatedStorage:WaitForChild("Modules"):WaitForChild("Network")
local actor = Network:WaitForChild("RemoteEvent")

local WindUI = loadstring(game:HttpGet("https://github.com/Footagesus/WindUI/releases/latest/download/main.lua"))()

local Window = WindUI:CreateWindow({
    Title = "VN Hub and Sea | Minh Hub - Forsaken",
    Icon = "rbxassetid://112407097340606",
    Author = "By ⟦ 春秋禪 ⟧ https://discord.gg/YQBhUfzY and Sea | Minh https://discord.gg/nHnsJF9TbN",
    Folder = "huyenvutongforsaken",
    
    Size = UDim2.fromOffset(780, 660),
    MinSize = Vector2.new(560, 350),
    MaxSize = Vector2.new(850, 560),
    Transparent = true,
    Theme = "Dark",
    Resizable = true,
    SideBarWidth = 200,
    BackgroundImageTransparency = 0.42,
    HideSearchBar = false,
    ScrollBarEnabled = true,
})

Window:EditOpenButton({
    Title = "Open Huyền Vũ Tông UI",
    Icon = "monitor",
    CornerRadius = UDim.new(0,16),
    StrokeThickness = 2,
    Color = ColorSequence.new( -- gradient
        Color3.fromHex("FF0F7B"), 
        Color3.fromHex("F89B29")
    ),
    OnlyMobile = false,
    Enabled = true,
    Draggable = true,
})

local TabInfo = Window:Tab({ Title = "Info", Icon = "info" })
local TabMain = Window:Tab({ Title = "Main", Icon = "house" })


TabInfo:Button({
    Title = "Copy Discord Link VN Hub",
    Description = "Copy link Discord",
    Callback = function()
        setclipboard("https://discord.gg/YQBhUfzY")
        Notify("Info", "Đã copy link Discord!")
    end
})

TabInfo:Button({
    Title = "Copy Discord Link Sea | Minh Hub",
    Description = "Copy link Discord",
    Callback = function()
        setclipboard("https://discord.gg/nHnsJF9TbN")
        Notify("Info", "Đã copy link Discord!")
    end
})

TabInfo:Paragraph({
    Title = "Đây là script tôi làm ra, mong bạn chơi vui vẻ!",
    Description = "vui"
})

TabMain:Button({
    Title = "Finish Generator",
    Description = "Hoàn thành generator gần nhất",
    Callback = function()
        if solveGeneratorCooldown then 
            Notify("Gen", "Vui lòng chờ cooldown!")
            return
        end
        if AutoFinishGen then
            Notify("Gen", "Vui lòng tắt Auto Finish Gen!")
            return
        end
        
        local gen = getClosestGenerator()
        if gen and gen:FindFirstChild("Remotes") and gen.Remotes:FindFirstChild("RE") then
            gen.Remotes.RE:FireServer()
            solveGeneratorCooldown = true
            task.delay(genDelay, function()
                solveGeneratorCooldown = false
            end)
        else
            Notify("Gen", "Không tìm thấy Generator gần nhất.")
        end
    end
})

TabMain:Toggle({
    Title = "Auto Finish Generator",
    Default = false,
    Callback = function(state)
        AutoFinishGen = state
        if state then
            if solveGeneratorCooldown then
                Notify("Gen", "Vui lòng chờ cooldown trước khi bật!", 4)
                AutoFinishGen = false
                return
            end
            
            task.spawn(function()
                while AutoFinishGen do
                    local gen = getClosestGenerator()
                    if gen and gen:FindFirstChild("Remotes") and gen.Remotes:FindFirstChild("RE") then
                        gen.Remotes.RE:FireServer()
                    end
                    
                    solveGeneratorCooldown = true
                    task.wait(genDelay)
                    solveGeneratorCooldown = false
                end
            end)
        else
            solveGeneratorCooldown = false
        end
    end
})

TabMain:Input({
    Title = "Generator Delay",
    Desc = "Input Generator Delay",
    Value = "3",
    Type = "Input",
    Placeholder = "1-10",
    Callback = function(input)
        genDelay = input
    end
})



TabMain:Toggle({
    Title = "Always Show Chat",
    Default = false,
    Callback = function(state)
        if state then
            _G.showChat = true
            task.spawn(function()
                while _G.showChat and task.wait() do
                    local chatConfig = game:GetService("TextChatService"):FindFirstChildOfClass("ChatWindowConfiguration")
                    if chatConfig then
                        chatConfig.Enabled = true
                    end
                end
            end)
        else
            _G.showChat = false
            local chatConfig = game:GetService("TextChatService"):FindFirstChildOfClass("ChatWindowConfiguration")
            if chatConfig then
                chatConfig.Enabled = false
            end
        end
    end
})
